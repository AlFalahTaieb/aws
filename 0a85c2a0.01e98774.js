(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{123:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return d}));var n=a(0),o=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=o.a.createContext({}),b=function(e){var t=o.a.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):c(c({},t),e)),a},p=function(e){var t=b(e.components);return o.a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},m=o.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,i=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),p=b(a),m=n,d=p["".concat(i,".").concat(m)]||p[m]||u[m]||r;return a?o.a.createElement(d,c(c({ref:t},s),{},{components:a})):o.a.createElement(d,c({ref:t},s))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=m;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:n,i[1]=c;for(var s=2;s<r;s++)i[s]=a[s];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"},176:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/cf-7579835cb17d819d3012fef3bc1e9c55.png"},57:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return c})),a.d(t,"rightToc",(function(){return l})),a.d(t,"Quote",(function(){return s})),a.d(t,"default",(function(){return p}));var n=a(2),o=a(6),r=(a(0),a(123)),i={id:"notes_cfm",title:"CloudFormation",author:"Taieb"},c={unversionedId:"notes_cfm",id:"notes_cfm",isDocsHomePage:!1,title:"CloudFormation",description:"export const Quote = ({ children, color }) => (",source:"@site/docs/notes_cfm.mdx",slug:"/notes_cfm",permalink:"/aws/docs/notes_cfm",version:"current",sidebar:"someSidebar",previous:{title:"ECS",permalink:"/aws/docs/notes_ecs"},next:{title:"SWF & Step Function",permalink:"/aws/docs/notes_ss"}},l=[{value:"I. Introduction",id:"i-introduction",children:[]},{value:"III. CloudFormation Tips",id:"iii-cloudformation-tips",children:[]}],s=function(e){var t=e.children;e.color;return Object(r.b)("span",{style:{backgroundColor:"#5a5a5a",borderRadius:"8px",color:"#FF9900",padding:"0.21rem"}},t)},b={rightToc:l,Quote:s};function p(e){var t=e.components,i=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},b,i,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"i-introduction"},"I. Introduction"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Infrastructure as Code (IaC)")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Declarative way of outlining your AWS infrastructure, for any resource (most are supported).")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"For instance, within a CloudFormation template, you can include"),Object(r.b)("ol",{parentName:"li"},Object(r.b)("li",{parentName:"ol"},"Security group"),Object(r.b)("li",{parentName:"ol"},"Two EC2s"),Object(r.b)("li",{parentName:"ol"},"Two EIPs for two EC2s"),Object(r.b)("li",{parentName:"ol"},"One S3 bucket"),Object(r.b)("li",{parentName:"ol"},"One ELB"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"CloudFormation would then spin up all these resources for you, in the exact order.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Code can be version controlled.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Each resource within the stack is tagged so you can calculate costs.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"As a way to save cost in dev, you can delete all resources at 5pm and bring them back up at 8am as you not working at night.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Automated generation of diagrams for your templates.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Declarative programming.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Process"),Object(r.b)("ol",{parentName:"li"},Object(r.b)("li",{parentName:"ol"},Object(r.b)(s,{mdxType:"Quote"},"Templates have to be uploaded in S3 and then referenced in CloudFormation")),Object(r.b)("li",{parentName:"ol"},"To update a template, you can't overwrite an existing one but create a new one"),Object(r.b)("li",{parentName:"ol"},"Stacks are identified by a name"),Object(r.b)("li",{parentName:"ol"},"Deleting a stack deletes every single artifact that was created"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Manual deploy \u2014 edit templates using CloudFormation designer")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Automated way \u2014 edit templates as a YAML file using AWS CLI")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Building blocks"),Object(r.b)("ol",{parentName:"li"},Object(r.b)("li",{parentName:"ol"},Object(r.b)(s,{mdxType:"Quote"},"Resources (mandatory)")),Object(r.b)("li",{parentName:"ol"},"Parameters \u2014 dynamic inputs to template"),Object(r.b)("li",{parentName:"ol"},"Mappings \u2014 static variables to template"),Object(r.b)("li",{parentName:"ol"},"Outputs \u2014 References to what has been created"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"StackSets"),Object(r.b)("ol",{parentName:"li"},Object(r.b)("li",{parentName:"ol"},"Pre-configured stacks that can be managed across multiple accounts and regions."),Object(r.b)("li",{parentName:"ol"},"Admin need to create it and share with trusted accounts."),Object(r.b)("li",{parentName:"ol"},"If you update a StackSet template, all associated instances are updated too (Symbol). ")))),Object(r.b)("p",null,Object(r.b)("img",{alt:"CloudFormation AWS",src:a(176).default})),Object(r.b)("h2",{id:"iii-cloudformation-tips"},"III. CloudFormation Tips"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"The ",Object(r.b)("inlineCode",{parentName:"p"},"cloudformation:TemplateURL"),", lets you specify where the CloudFormation template for a stack action, such as create or update, resides and enforce that it be used.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)(s,{mdxType:"Quote"},"You can use CloudFormation to orchestrate settings for OUs including VPC and subnets.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Use a ",Object(r.b)("inlineCode",{parentName:"p"},"DeletionPolicy")," to preserve or backup a resource when its stack is deleted or updated")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"It's good practice to create layered architecture with a CloudFormation template for each layer.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"AWS QuickStarts are standard templates to create full apps from scratch.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Works hand-in-hand with OpsWorks (Chef and Puppet).")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"You can nest stacks.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Integrated with CloudTrail.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Through AWS PrivateLink, you can use CloudFormation APIs inside of your VPC and route data between your VPC and CloudFormation entirely within the AWS network.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)(s,{mdxType:"Quote"},"If a resource cannot be created, CloudFormation rolls the stack back and automatically deletes any resources that were created."),"If a resource cannot be deleted , any remaining resources are retained until the stack can be successfully deleted."),Object(r.b)("li",{parentName:"ol"},Object(r.b)(s,{mdxType:"Quote"},"Stack update methods \u2014 Direct update and Creating/Executing change sets")),Object(r.b)("li",{parentName:"ol"},Object(r.b)(s,{mdxType:"Quote"},"Drift detection enables you to detect whether a stack's actual configuration differs, or has drifted, from it's expected configuration.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"To share information between stacks, export a stack's output values. Other stack in the same account can then import those values.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"Stacksets allow you to roll out CloudFormation stacks over multiple accounts and regions easily. Often used alongside AWS Organizations to centrally deploy and manage services in different accounts.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"You can assign logical names to AWS resources in a template. When a stack is created, AWS CloudFormation binds the logical name to the name of the corresponding actual AWS resource.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"CloudFormation doesn\u2019t allow this for all resources.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"AWS CloudFormation provides a set of application bootstrapping scripts that enable you to install packages, files, and services on your EC2 instances simply by describing them in your CloudFormation template.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)(s,{mdxType:"Quote"},"CloudFormation allows you to define deletion policies for resources in the template. You can specify that snapshots be created for Amazon EBS volumes or Amazon RDS database instances before they are deleted.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)(s,{mdxType:"Quote"},"You can also specify that a resource should be preserved and not deleted when the stack is deleted. This is useful for preserving Amazon S3 buckets when the stack is deleted.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"You can use CloudFormation to ",Object(r.b)(s,{mdxType:"Quote"},"modify and update the resources"),"\nin your existing stacks in a controlled and predictable way.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)(s,{mdxType:"Quote"},"You WILL be charged for resources that were rolled back during a failed stack creation attempt.")),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"You can create up to 200 resources per stack."))))}p.isMDXComponent=!0}}]);