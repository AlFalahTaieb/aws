(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{107:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return c})),a.d(t,"Quote",(function(){return b})),a.d(t,"default",(function(){return p}));var r=a(2),o=a(6),n=(a(0),a(123)),i={id:"notes_r53",title:"Route 53",sidebar_label:"Route 53",author:"Taieb"},l={unversionedId:"notes_r53",id:"notes_r53",isDocsHomePage:!1,title:"Route 53",description:"export const Quote = ({ children, color }) => (",source:"@site/docs/notes_r53.mdx",slug:"/notes_r53",permalink:"/aws/docs/notes_r53",version:"current",sidebar_label:"Route 53",sidebar:"someSidebar",previous:{title:"ElastiCache",permalink:"/aws/docs/notes_ec"},next:{title:"CloudFront",permalink:"/aws/docs/notes_cf"}},c=[{value:"I. Introduction",id:"i-introduction",children:[]},{value:"II. Records",id:"ii-records",children:[]},{value:"III. Features",id:"iii-features",children:[]},{value:"IV. TTL",id:"iv-ttl",children:[]},{value:"V. Health checks",id:"v-health-checks",children:[]},{value:"VI. Route53 as a registrar",id:"vi-route53-as-a-registrar",children:[]},{value:"VII. Failovers",id:"vii-failovers",children:[]},{value:"VIII. Route53 Tips",id:"viii-route53-tips",children:[]},{value:"IX Routings",id:"ix-routings",children:[]}],b=function(e){var t=e.children;e.color;return Object(n.b)("span",{style:{backgroundColor:"#5a5a5a",borderRadius:"8px",color:"#FF9900",padding:"0.21rem"}},t)},s={rightToc:c,Quote:b};function p(e){var t=e.components,i=Object(o.a)(e,["components"]);return Object(n.b)("wrapper",Object(r.a)({},s,i,{components:t,mdxType:"MDXLayout"}),Object(n.b)("h2",{id:"i-introduction"},"I. Introduction"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},"It is a DNS service by AWS. DNS converts human-friendly domain names into IPs."),Object(n.b)("li",{parentName:"ol"},"IPv4 has over 4 billion addresses that are quickly running out. Most ISPs are unwilling to switch to IPv6."),Object(n.b)("li",{parentName:"ol"},"Top Level Domain (TLD) are assigned by Internet Assigned Numbers Authority (IANA)."),Object(n.b)("li",{parentName:"ol"},"Domain Registrars (GoDaddy etc) is the authority that can assign domain names under on or more TLDs. These domain names are registered with InterNIC, a service by ICANN that enforces uniqueness."),Object(n.b)("li",{parentName:"ol"},"Each domain name becomes registered in a central db called WhoIS"),Object(n.b)("li",{parentName:"ol"},'"A" record stands for address, it is used to convert domain name to an IP address'),Object(n.b)("li",{parentName:"ol"},"TTL is the time for which the IP address of a domain name is stored on either the user's computer or resolving server."),Object(n.b)("li",{parentName:"ol"},"The lower the TTL, the faster DNS changes would reflect"),Object(n.b)("li",{parentName:"ol"},"CNAME record is used to map multiple domain names to a single one e.g. ",Object(n.b)("a",Object(r.a)({parentName:"li"},{href:"http://m.myapp.com"}),"m.myapp.com")," and ",Object(n.b)("a",Object(r.a)({parentName:"li"},{href:"http://mobile.myapp.com"}),"mobile.myapp.com")),Object(n.b)("li",{parentName:"ol"},"Alias records \u2014 same as CNAME except CNAME cannot be used for naked addresses i.e. a domain name without www"),Object(n.b)("li",{parentName:"ol"},"ELBs do not have pre-defined IPv4 addresses, you resolve them using a DNS name"),Object(n.b)("li",{parentName:"ol"},"Given choice between Alias record or CNAME, use Alias.")),Object(n.b)("h2",{id:"ii-records"},"II. Records"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},Object(n.b)("strong",{parentName:"li"},"A"),": hostname to IPv4")),Object(n.b)("ol",{start:2},Object(n.b)("li",{parentName:"ol"},Object(n.b)("strong",{parentName:"li"},"AAAA"),": hostname to IPv6")),Object(n.b)("ol",{start:3},Object(n.b)("li",{parentName:"ol"},Object(n.b)("strong",{parentName:"li"},"CNAME"),": hostname to hostname")),Object(n.b)("ol",{start:4},Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},Object(n.b)("a",Object(r.a)({parentName:"p"},{href:"http://app.mydomain.com"}),"app.mydomain.com")," \u2192 ",Object(n.b)("a",Object(r.a)({parentName:"p"},{href:"http://app.yourdomain.com"}),"app.yourdomain.com"))),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"It should only be used when there are not other records on that name")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"AWS resources have long URLs but we want short and sweet myapp.com")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Only work for NON-ROOT domain e.g. ",Object(n.b)("a",Object(r.a)({parentName:"p"},{href:"http://hello.myapp.com"}),"hello.myapp.com")," but not myapp.com")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"You have to pay for it")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Cannot be used with apex (naked) domains (app.com)")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},Object(n.b)("strong",{parentName:"p"},"Alias"),": hostname to AWS resource"))),Object(n.b)("ol",{start:11},Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},Object(n.b)("a",Object(r.a)({parentName:"p"},{href:"http://myapp.com"}),"myapp.com")," to ",Object(n.b)("a",Object(r.a)({parentName:"p"},{href:"http://myapp.amazonaws.com"}),"myapp.s3.amazonaws.com"))),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Prefer it over CNAME when using internal AWS resources")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Works for both root (zone-apex) and non-root domain")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Free of cost and native health check")),Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"Resources include ELB, API Gateway, S3, VPC endpoints and Beanstalk")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"You CANNOT point an Alias record directly at an on-premises web server"))),Object(n.b)("h2",{id:"iii-features"},"III. Features"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Route53 can use"),Object(n.b)("ol",{parentName:"li"},Object(n.b)("li",{parentName:"ol"},"public domain names you own"),Object(n.b)("li",{parentName:"ol"},"private domain names that can be resolved only within your VPC"))),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Some advanced features include"),Object(n.b)("ol",{parentName:"li"},Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Load balancing (through DNS - also called client load balancing)")),Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"Health checks")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Routing policy (simple, failover etc)")))),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"You pay \\$0.50 per month per hosted zone."))),Object(n.b)("h2",{id:"iv-ttl"},"IV. TTL"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},"TTL is a way of caching DNS results to avoid overwhelming the DNS server."),Object(n.b)("li",{parentName:"ol"},"Browsers have to wait for their TTL to expire to redo the query.",Object(n.b)("ol",{parentName:"li"},Object(n.b)("li",{parentName:"ol"},"High TTL (24 hours)"),Object(n.b)("li",{parentName:"ol"},"Low TTL (60s)"))),Object(n.b)("li",{parentName:"ol"},"TTL is mandatory for each DNS record.")),Object(n.b)("h2",{id:"v-health-checks"},"V. Health checks"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},"Have X (default = 3) health checks failed? \u2192 Unhealthy"),Object(n.b)("li",{parentName:"ol"},"Have X (default = 3) health checks passed? \u2192 Healthy"),Object(n.b)("li",{parentName:"ol"},"Default health check interval: 30s (can be set to 10s at a higher cost)"),Object(n.b)("li",{parentName:"ol"},"About 15 health checkers will check the endpoint health \u2014 one request/2s on average"),Object(n.b)("li",{parentName:"ol"},"Can have HTTP/HTTPS/TCP health checks")),Object(n.b)("p",null,Object(n.b)("img",{alt:"Route 53 AWS",src:a(249).default})),Object(n.b)("h2",{id:"vi-route53-as-a-registrar"},"VI. Route53 as a registrar"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"A domain name registrar is an organization that manages the reservation of internet domain names e.g. namecheap and godaddy")),Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"Route53 can also act as a registrar.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Domain registrar \u2260 DNS but each registrar comes with some DNS features e.g. adding A and CNAME records.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"It is possible to use Route53 even though you bought domain name elsewhere."),Object(n.b)("ol",{parentName:"li"},Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},'Create a "hosted zone" on Route53')),Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"Update NS records on third-party website to use Route53 name servers")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Check video #88"))))),Object(n.b)("h2",{id:"vii-failovers"},"VII. Failovers"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"You can use Route 53 health checking to configure active-active and active-passive failover configurations."),"You configure active-active failover using any routing policy (or combination of routing policies) other than failover, and you configure active-passive failover using the failover routing policy.")),Object(n.b)("ol",{start:2},Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"Active-active failover")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Use this failover configuration when you want all of your resources to be available the majority of the time.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"When responding to queries, Route 53 includes ALL resources.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"When a resource becomes unavailable, Route 53 can detect that it's unhealthy and stop including it when responding to queries.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"In active-active failover, all the records that have the same name, the same type (such as A or AAAA), and the same routing policy (such as weighted or latency) are active unless Route 53 considers them unhealthy.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"No concept of primary/secondary")),Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"Active-passive failover")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Use an active-passive failover configuration when you want a ",Object(n.b)(b,{mdxType:"Quote"},"primary"),"resource or group of resources to be available the majority of the time and you want a ",Object(n.b)(b,{mdxType:"Quote"},"secondary"),"resource or group of resources to be on standby in case all the primary resources become unavailable.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"When responding to queries, Route 53 includes only the healthy primary resources.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"If ALL the primary resources are unhealthy, Route 53 begins to include only the healthy secondary resources in response to DNS queries."))),Object(n.b)("h2",{id:"viii-route53-tips"},"VIII. Route53 Tips"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"If you already have a domain name from another registrar, you can use ",Object(n.b)("inlineCode",{parentName:"p"},"CreateHostedZone")," API to create a hosted zone that can store DNS records for your domain.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Your hosted zone will be initially populated with a basic set of DNS records, including four virtual name servers that will answer queries for your domain.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"Route 53 uses AWS' infrastructure backbone to provide HA.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"You can create multiple hosted zones for the same domain name.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Supports wildcard entries")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Amazon Route 53 does not support DNSSEC for DNS at this time. But Amazon Route 53 allows DNSSEC on domain registration.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"You can map your zone apex (",Object(n.b)(b,{mdxType:"Quote"},"app.com"),"vs ",Object(n.b)("a",Object(r.a)({parentName:"p"},{href:"http://www.app.com"}),"www.app.com"),") to S3, CloudFront, Beanstalk, API Gateway and VPC.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Private DNS is a Route 53 feature that lets you have authoritative DNS within your VPCs without exposing your DNS records (including the name of the resource and its IP address(es) to the Internet.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"You can configure DNS Failover for Elastic Load Balancers (ELBs). To enable DNS Failover for an ELB endpoint, create an Alias record pointing to the ELB and set the ",Object(n.b)("inlineCode",{parentName:"p"},"EvaluateTargetHealth")," parameter to ",Object(n.b)("inlineCode",{parentName:"p"},"true"),". Route 53 creates and manages the health checks for your ELB automatically.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"You can use DNS Failover to maintain a backup site (for example, a static site running on an Amazon S3 website bucket) and fail over to this site in the event that your primary site becomes unreachable."),"([Link](https://aws.amazon.com/premiumsupport/knowledge-center/route-53-dns-health-checks/))")),Object(n.b)("ol",{start:11},Object(n.b)("li",{parentName:"ol"},Object(n.b)(b,{mdxType:"Quote"},"Route 53 can only fail over to an endpoint that is healthy. If there are no healthy endpoints remaining in a resource record set, Route 53 will behave as if all health checks are passing.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"CloudWatch metrics for Route 53 health checks are available free of charge.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"Amazon Route 53 is both an Authoritative DNS service and Recursive DNS service. Authoritative DNS contains the final answer to a DNS query, generally an IP address. Clients (such as mobile devices, applications running in the cloud, or servers in your datacenter) don\u2019t actually talk directly to authoritative DNS services, except in very rare cases. Instead, clients talk to recursive DNS services (also known as DNS resolvers) which find the correct authoritative answer for any DNS query. Route 53 Resolver is a recursive DNS service.")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("p",{parentName:"li"},"A DNS endpoint includes one or more elastic network interfaces (ENI) that attach to your Amazon Virtual Private Cloud (VPC). Each ENI is assigned an IP address from the subnet space of the VPC where it is located. This IP address can then serve as a forwarding target for on-premises DNS servers to forward queries."))),Object(n.b)("h2",{id:"ix-routings"},"IX Routings"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},Object(n.b)("strong",{parentName:"li"},"Simple"),Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"Only one record for multiple IPs"),Object(n.b)("li",{parentName:"ul"},"If you specify multiple IPs, Route53 would return them in random order"),Object(n.b)("li",{parentName:"ul"},"No health checks"))),Object(n.b)("li",{parentName:"ol"},Object(n.b)("strong",{parentName:"li"},"Weighted"),Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"Splits traffic based on rule"),Object(n.b)("li",{parentName:"ul"},"Used with active-active systems"),Object(n.b)("li",{parentName:"ul"},"e.g. 80% to us-east-1 and 20% to eu-west-1"),Object(n.b)("li",{parentName:"ul"},"Helpful in situations when you want a small % of traffic going to new app version"),Object(n.b)("li",{parentName:"ul"},"Can be associated with health checks"))),Object(n.b)("li",{parentName:"ol"},Object(n.b)("strong",{parentName:"li"},"Latency-based"),Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"Selects the route with lowest network latency for the end user"))),Object(n.b)("li",{parentName:"ol"},Object(n.b)("strong",{parentName:"li"},"Failover"),Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"Selects based on health of the server"),Object(n.b)("li",{parentName:"ul"},"Used for disaster recovery"),Object(n.b)("li",{parentName:"ul"},"Used with active-passive policy"),Object(n.b)("li",{parentName:"ul"},"e.g. primary EC2 in us-east-1 and secondary S3 in eu-west-1"))),Object(n.b)("li",{parentName:"ol"},Object(n.b)("strong",{parentName:"li"},"Geolocation"),Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"Routing based on location of the end user"))),Object(n.b)("li",{parentName:"ol"},Object(n.b)("strong",{parentName:"li"},"Geoproximity"),Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"Routing based on geographical location of users as well as resources"),Object(n.b)("li",{parentName:"ul"},"Optionally choose to drive more/less traffic (aka throttle) to a given resource by a value, known as ",Object(n.b)("strong",{parentName:"li"},"bias")),Object(n.b)("li",{parentName:"ul"},"A ",Object(n.b)("strong",{parentName:"li"},"bias")," expands or shrinks the size of the geographic region from which traffic is routed to a resource"))),Object(n.b)("li",{parentName:"ol"},Object(n.b)("strong",{parentName:"li"},"Multi-value Answer")," ",Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"Same as simple routing with health checks"),Object(n.b)("li",{parentName:"ul"},"Up to 8 healthy records are returned for each multi-value query"),Object(n.b)("li",{parentName:"ul"},"It's not a substitute for ELB")))))}p.isMDXComponent=!0},123:function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return d}));var r=a(0),o=a.n(r);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,r,o=function(e,t){if(null==e)return{};var a,r,o={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var b=o.a.createContext({}),s=function(e){var t=o.a.useContext(b),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=s(e.components);return o.a.createElement(b.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},u=o.a.forwardRef((function(e,t){var a=e.components,r=e.mdxType,n=e.originalType,i=e.parentName,b=c(e,["components","mdxType","originalType","parentName"]),p=s(a),u=r,d=p["".concat(i,".").concat(u)]||p[u]||m[u]||n;return a?o.a.createElement(d,l(l({ref:t},b),{},{components:a})):o.a.createElement(d,l({ref:t},b))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var n=a.length,i=new Array(n);i[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var b=2;b<n;b++)i[b]=a[b];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"},249:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/r53_1-27d8e6bf7bbba2bff4d3ba7c8a8475ff.png"}}]);