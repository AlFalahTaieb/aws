<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<title data-react-helmet="true">CloudWAtch | AWS SAA-C02 Ressources</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="CloudWAtch | AWS SAA-C02 Ressources"><meta data-react-helmet="true" name="description" content="export const Quote = ({ children, color }) =&gt; ("><meta data-react-helmet="true" property="og:description" content="export const Quote = ({ children, color }) =&gt; ("><meta data-react-helmet="true" property="og:url" content="https://AlFalahTaieb.github.io/aws/docs/notes_cw"><link data-react-helmet="true" rel="shortcut icon" href="/aws/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://AlFalahTaieb.github.io/aws/docs/notes_cw"><link rel="stylesheet" href="/aws/styles.d664286d.css">
<link rel="preload" href="/aws/styles.e3d237d5.js" as="script">
<link rel="preload" href="/aws/runtime~main.5987bc8c.js" as="script">
<link rel="preload" href="/aws/main.db8832c0.js" as="script">
<link rel="preload" href="/aws/2.eacc328a.js" as="script">
<link rel="preload" href="/aws/3.5084f581.js" as="script">
<link rel="preload" href="/aws/66.73ad6aef.js" as="script">
<link rel="preload" href="/aws/67.520034c4.js" as="script">
<link rel="preload" href="/aws/935f2afb.52a1d31c.js" as="script">
<link rel="preload" href="/aws/17896441.17a33e11.js" as="script">
<link rel="preload" href="/aws/9c36215a.40d9e239.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" target="_self" href="/aws/docs/start"><img class="navbar__logo" src="/aws/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">AWS SAA-C02 Ressources</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/aws/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://alfelah.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Taieb</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" target="_self" href="/aws/docs/start"><img class="navbar__logo" src="/aws/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">AWS SAA-C02 Ressources</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/aws/docs/">Docs</a></li><li class="menu__list-item"><a href="https://alfelah.com" target="_blank" rel="noopener noreferrer" class="menu__link">Taieb</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">AWS Certified Solutions Architect Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/start">Getting Started üèéÔ∏è</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/raz">Regions &amp; AZ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_sg">Security Groups</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_iam">IAM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ec2">EC2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_asg">ASG</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_elb">ELB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ebs_efs">EBS &amp; EFS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_fsx">FSx</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_s3">S3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_storage_ex">Storage Extras</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_athena">Athena</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_datasync">DataSync</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_cli_sdk">CLI &amp; SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_rds">RDS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_redshift">Redshift</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_lambda">Lambda</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_dynamodb">DynamoDB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_apig">API Gateway</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_cognito">Cognito</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ec">ElastiCache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_r53">Route 53</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_cf">CloudFront</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_bs">BeanStalk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_sqs">SQS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_sns">SNS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_kenesis">Kenesis</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/aws/docs/notes_cw">CloudWAtch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ct">CloudTrail</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_kms">KMS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ssm">SSM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_sw">Shield &amp; WAF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_vpc">VPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ecs">ECS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_cfm">CloudFormation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ss">SWF &amp; Step Function</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_os">Other Services</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_dr">Disaster Recovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_hpc">HPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_fp">Five Pillars</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes">Notes for AWS Certified Solutions Architect Associate</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">CloudWAtch</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="i-introduction"></a>I. Introduction<a aria-hidden="true" tabindex="-1" class="hash-link" href="#i-introduction" title="Direct link to heading">#</a></h2><ol><li><span style="background-color:#5a5a5a;border-radius:8px;color:#FF9900;padding:0.21rem">CloudWatch provides metrics for every service in AWS.</span></li><li><p>CloudWatch Metrics are the fundamental concept in CloudWatch. </p><ol><li>A metric represents a time-ordered set of data points that are published to CloudWatch.</li><li>You cannot use a metric alone, it is used when setting up monitoring for any service in CloudWatch.</li><li>Metric = CPU utilization, network latency etc</li><li>Metrics belong to namespaces</li><li>Metrics have timestamps</li><li>Can create dashboard of metrics</li><li>Dimension is an attribute of a metric (instance ID, env)</li></ol></li><li><p>CloudWatch Events delivers a near real-time stream of system events that describe changes in Amazon Web Services (AWS) resources.</p></li><li><p>You use CloudWatch Logs to monitor applications and systems using log data. For example, CloudWatch Logs can track the number of errors that occur in your application logs and send you a notification whenever the rate of errors exceeds a threshold you specify.</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ii-cloudwatch-with-ec2"></a>II. CloudWatch with EC2<a aria-hidden="true" tabindex="-1" class="hash-link" href="#ii-cloudwatch-with-ec2" title="Direct link to heading">#</a></h2><ol><li>EC2 instance have default every 5 minutes, can be bumped up to every 1 minute with <strong>Detailed Monitoring</strong> (costly).</li><li>Use <strong>Detailed Monitoring</strong> if you want to prompt scale your ASG. Note that detailed monitoring does not provide any additional insight, it just increases the frequency of already available metrics. If you want more granular metrics, use CloudWatch agent or scripts.</li><li>The free tier allows us to have 10 detailed monitoring metrics.</li><li><span style="background-color:#5a5a5a;border-radius:8px;color:#FF9900;padding:0.21rem">EC2 memory usage is NOT pushed by default, use Agent!</span></li><li><span style="background-color:#5a5a5a;border-radius:8px;color:#FF9900;padding:0.21rem">CloudWatch logs can collect app logs to count all 200s, 404s, 500s etc.</span></li><li>For instance recovery, EC2 provides two ways of status checks<ol><li>Instance status = check the EC2 VM</li><li>System status = check the underlying hardware</li><li>If either of the above fail, then the instance is down.</li><li>You can configure CLoudWatch to recover the instance if the above happens.</li><li>Recovery: Same private/public/elastic IP, metadata, placement group.</li></ol></li></ol><p><img alt="CloudWatch AWS" src="/aws/assets/images/cw1-c562b7f1d06eb77861753ac11fd1a2bc.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="iii-custom-metrics"></a>III. Custom metrics<a aria-hidden="true" tabindex="-1" class="hash-link" href="#iii-custom-metrics" title="Direct link to heading">#</a></h2><ol><li><p>Possibility to define and send your own custom metrics.</p></li><li><p>Ability to use dimensions (attributes) to segment metrics.</p><ol><li><code>instance.id</code></li><li><code>environment.name</code></li></ol></li><li><p>Metric resolution</p><ol><li>Standard: 1 minute</li><li>High-res: up to 1s (StorageResolution API parameter) ‚Äî higher cost </li></ol></li><li><p>To send a metric to CloudWatch, you can use the PutMetricData API.</p></li><li><p>Use exponential backoff in case of errors.</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="iv-dashboards"></a>IV. Dashboards<a aria-hidden="true" tabindex="-1" class="hash-link" href="#iv-dashboards" title="Direct link to heading">#</a></h2><ol><li>Great way to setup dashboards for quick access to keys metrics.</li><li><span style="background-color:#5a5a5a;border-radius:8px;color:#FF9900;padding:0.21rem">Dashboards are global ‚Äî can include graphs from different regions.</span></li><li>You can set timezone and refresh rates (10s - 15min)</li><li>Pricing<ol><li>3 dashboards (each up to 50 metrics) for free</li><li>$3/dashboard/month after that</li></ol></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="v-logs"></a>V. Logs<a aria-hidden="true" tabindex="-1" class="hash-link" href="#v-logs" title="Direct link to heading">#</a></h2><ol><li><p>Applications can send logs to CloudWatch using the SDK.</p></li><li><p>CloudWatch can collect log from</p><ol><li>Elastic Beanstalk: collection of logs from application</li><li>ECS: collection from containers</li><li>Lambda: from function logs</li><li>VPC flow logs (like Wireshark)</li><li>API Gateway</li><li>CloudTrail based on filter</li><li>CLoudWatch log agents (e.g. on EC2 machines)</li><li>Route53: DNS queries</li></ol></li><li><p>CloudWatch logs can go to</p><ol><li><strong>S3 for archival</strong></li><li><strong>Stream to ES for analytics</strong></li></ol></li><li><p>Logs storage architecture</p><ol><li>Log groups: arbitrary name, usually representing the application</li><li>Log group ‚Üí Log stream: instances within application/log files/containers </li></ol></li><li><p>Can define log expiration policies (never expire, 30 days etc)</p></li><li><p>AWS CLI can tail the logs for real-time monitoring</p></li><li><p>Make sure IAM permission are correct before sending logs</p></li><li><span style="background-color:#5a5a5a;border-radius:8px;color:#FF9900;padding:0.21rem">Logs can be encrypted using KMS</span></li><li><p>CloudWatch logs can use filter expressions</p><ol><li>find a specific IP</li><li>metric filters can be used to trigger alarm</li></ol></li><li><span style="background-color:#5a5a5a;border-radius:8px;color:#FF9900;padding:0.21rem">New features include &quot;Insight&quot; to interactively search logs and add it to dashboard.</span></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="vi-cloudwatch-agent"></a>VI. CloudWatch Agent<a aria-hidden="true" tabindex="-1" class="hash-link" href="#vi-cloudwatch-agent" title="Direct link to heading">#</a></h2><ol><li><span style="background-color:#5a5a5a;border-radius:8px;color:#FF9900;padding:0.21rem">By default, no logs from EC2 are going to CloudWatch. You need to install the agent.</span></li><li><span style="background-color:#5a5a5a;border-radius:8px;color:#FF9900;padding:0.21rem">Make sure your EC2 instance has the right IAM role i.e. it can write to CloudWatch.</span></li><li><p>The agent can be set up on physical on-prem servers as well.</p></li><li><p>Out-of-the-box metrics only include a high level overview of CPU, disk and network.</p></li><li><p><strong>Standard CloudWatch Agent</strong></p><ol><li>older version</li><li>can only send to CloudWatch logs</li></ol></li><li><p><strong>Unified Agent for EC2</strong></p><ol><li>Newer version</li><li>Centralized configuration using SSM parameter store</li><li>Can collect additional system metrics<ol><li>CPU (active, guest, idle, user)</li><li>Disk (IO, # reads, # writes)</li><li>RAM (free, inactive, total, cached)</li><li>Netstat (# of TCP and UDP connections, net packets, bytes)</li><li>Processes (total, dead, bloqued, idle, running, sleep)</li><li>Swap space (free, used, used %)</li></ol></li></ol></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="vii-alarms"></a>VII. Alarms<a aria-hidden="true" tabindex="-1" class="hash-link" href="#vii-alarms" title="Direct link to heading">#</a></h2><ol><li><p>Alarms are used to trigger notifications for any metric.</p></li><li><p>Alarms can go to auto scaling, EC2 actions, SNS notifications</p></li><li><p>Various options (sampling, %, max, min)</p></li><li><p>Alarm states</p><ol><li><code>OK</code></li><li><code>INSUFFICIENT_DATA</code></li><li><code>ALARM</code></li></ol></li><li><p>Period</p><ol><li>Length of time in seconds to evaluate the metric</li><li>High-res custom metrics: can choose either 10s or 30s</li></ol></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="viii-events"></a>VIII. Events<a aria-hidden="true" tabindex="-1" class="hash-link" href="#viii-events" title="Direct link to heading">#</a></h2><ol><li>Schedule cron jobs</li><li>Event pattern: event rules to react to a service doing something</li><li>Triggers to SQS, SNS, Lambda, or kinesis</li><li>CloudWatch event creates a small JSON document to give information about the change</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ix-cloudwatch-tips"></a>IX. CloudWatch Tips<a aria-hidden="true" tabindex="-1" class="hash-link" href="#ix-cloudwatch-tips" title="Direct link to heading">#</a></h2><ol><li>You can use the CloudWatch agent to collect both system metrics and log files from Amazon EC2 instances and on-premises servers. The agent supports both Windows Server and Linux, and enables you to select the metrics to be collected, including sub-resource metrics such as per-CPU core.</li><li>CloudWatch does not aggregate data across regions and so metrics are tightly bound to one region only.</li><li>A <strong>namespace</strong> is a container for CloudWatch metrics. There is no default namespace.</li><li>You can assign up to 10 dimensions to a metric.</li><li>You are charged per 1000 metrics per month.</li></ol></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/aws/docs/notes_kenesis"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Kenesis</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/aws/docs/notes_ct"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CloudTrail ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#i-introduction" class="table-of-contents__link">I. Introduction</a></li><li><a href="#ii-cloudwatch-with-ec2" class="table-of-contents__link">II. CloudWatch with EC2</a></li><li><a href="#iii-custom-metrics" class="table-of-contents__link">III. Custom metrics</a></li><li><a href="#iv-dashboards" class="table-of-contents__link">IV. Dashboards</a></li><li><a href="#v-logs" class="table-of-contents__link">V. Logs</a></li><li><a href="#vi-cloudwatch-agent" class="table-of-contents__link">VI. CloudWatch Agent</a></li><li><a href="#vii-alarms" class="table-of-contents__link">VII. Alarms</a></li><li><a href="#viii-events" class="table-of-contents__link">VIII. Events</a></li><li><a href="#ix-cloudwatch-tips" class="table-of-contents__link">IX. CloudWatch Tips</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/aws/styles.e3d237d5.js"></script>
<script src="/aws/runtime~main.5987bc8c.js"></script>
<script src="/aws/main.db8832c0.js"></script>
<script src="/aws/2.eacc328a.js"></script>
<script src="/aws/3.5084f581.js"></script>
<script src="/aws/66.73ad6aef.js"></script>
<script src="/aws/67.520034c4.js"></script>
<script src="/aws/935f2afb.52a1d31c.js"></script>
<script src="/aws/17896441.17a33e11.js"></script>
<script src="/aws/9c36215a.40d9e239.js"></script>
</body>
</html>