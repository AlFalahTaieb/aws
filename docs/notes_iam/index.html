<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<title data-react-helmet="true">IAM | AWS SAA-C02 Ressources</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="IAM | AWS SAA-C02 Ressources"><meta data-react-helmet="true" name="description" content="export const Highlight = ({ children, color }) =&gt; ("><meta data-react-helmet="true" property="og:description" content="export const Highlight = ({ children, color }) =&gt; ("><meta data-react-helmet="true" property="og:url" content="https://AlFalahTaieb.github.io/aws/docs/notes_iam"><link data-react-helmet="true" rel="shortcut icon" href="/aws/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://AlFalahTaieb.github.io/aws/docs/notes_iam"><link rel="stylesheet" href="/aws/styles.d664286d.css">
<link rel="preload" href="/aws/styles.e3d237d5.js" as="script">
<link rel="preload" href="/aws/runtime~main.5987bc8c.js" as="script">
<link rel="preload" href="/aws/main.db8832c0.js" as="script">
<link rel="preload" href="/aws/2.eacc328a.js" as="script">
<link rel="preload" href="/aws/3.5084f581.js" as="script">
<link rel="preload" href="/aws/66.73ad6aef.js" as="script">
<link rel="preload" href="/aws/67.520034c4.js" as="script">
<link rel="preload" href="/aws/935f2afb.52a1d31c.js" as="script">
<link rel="preload" href="/aws/17896441.17a33e11.js" as="script">
<link rel="preload" href="/aws/a75ebbb0.ff55213a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" target="_self" href="/aws/docs/start"><img class="navbar__logo" src="/aws/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">AWS SAA-C02 Ressources</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/aws/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://alfelah.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Taieb</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" target="_self" href="/aws/docs/start"><img class="navbar__logo" src="/aws/img/logo.svg" alt="My Site Logo"><strong class="navbar__title">AWS SAA-C02 Ressources</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/aws/docs/">Docs</a></li><li class="menu__list-item"><a href="https://alfelah.com" target="_blank" rel="noopener noreferrer" class="menu__link">Taieb</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">AWS Certified Solutions Architect Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/start">Getting Started üèéÔ∏è</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/raz">Regions &amp; AZ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_sg">Security Groups</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/aws/docs/notes_iam">IAM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ec2">EC2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_asg">ASG</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_elb">ELB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ebs_efs">EBS &amp; EFS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_fsx">FSx</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_s3">S3</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_storage_ex">Storage Extras</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_athena">Athena</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_datasync">DataSync</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_cli_sdk">CLI &amp; SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_rds">RDS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_redshift">Redshift</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_lambda">Lambda</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_dynamodb">DynamoDB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_apig">API Gateway</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_cognito">Cognito</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ec">ElastiCache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_r53">Route 53</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_cf">CloudFront</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_bs">BeanStalk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_sqs">SQS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_sns">SNS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_kenesis">Kenesis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_cw">CloudWAtch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ct">CloudTrail</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_kms">KMS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ssm">SSM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_sw">Shield &amp; WAF</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_vpc">VPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ecs">ECS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_cfm">CloudFormation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_ss">SWF &amp; Step Function</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_os">Other Services</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_dr">Disaster Recovery</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_hpc">HPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes_fp">Five Pillars</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/aws/docs/notes">Notes for AWS Certified Solutions Architect Associate</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">IAM</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="i-introduction"></a>I. Introduction<a aria-hidden="true" tabindex="-1" class="hash-link" href="#i-introduction" title="Direct link to heading">#</a></h2><ol><li><p>IAM is the center of AWS.</p></li><li><p>Root account should never be used or shared.</p></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem"> &quot;Users&quot; and &quot;Groups&quot; are for people, &quot;Roles&quot; are for machines.</span></li><li><p>&quot;Permissions&quot; are governed by &quot;Policies&quot; which are in JSON format.</p></li><li><p>An IAM group is a collection of IAM users. Groups let you specify permissions for multiple users, which can make it easier to manage the permissions for those users.</p><ol><li>Groups are collections of users and have policies attached to them</li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">A group is not an identity and cannot be identified as a principal in an IAM policy</span></li><li>Use groups to assign permissions to users</li><li>IAM groups cannot be used to group EC2 instances</li><li><strong>Groups cannot belong to other groups aka no nesting!</strong></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">CANNOT add role to a group</span></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">Only users and services can assume a role to take on permissions (NOT groups)</span></li></ol></li><li><p>IAM comes with managed policies.</p></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">It&#x27;s best to give users least amount of permissions they need to perform their job.</span></li><li><p>IAM Federation - Big enterprises have their own repo of users that can be integrated with IAM. This way, one can login into AWS using their company credentials (SAML).</p></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">One IAM user per physical person.</span></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">One IAM role per application.</span></li><li><p><strong>IAM roles cannot make direct requests to AWS services</strong>; <span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">they are meant to be assumed</span> by authorized entities, such as IAM users, applications, or AWS services such as EC2. Use IAM roles to delegate access within or between AWS accounts.</p></li><li><p>IAM credentials should never be shared.</p></li><li><p>Never use root account except for initial setup.</p></li><li><p>Always create an IAM user when setting up AWS!</p></li></ol><p><img alt="IAM" src="/aws/assets/images/iam1-52d0fb2bf31593f56b5ad465ed5da0ef.png"></p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_1w39 tabs__item--active" style="outline:none">When to Create IAM user</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_1w39" style="outline:none">When to Create IAM group</li></ul><div role="tabpanel" class="margin-vert--md"><div><li>You created an AWS account and you&#x27;re the only person who works in your account.</li><li>Other people in your group need to work in your AWS account, and your group is using no other identity mechanism.</li><li>You want to use the command-line interface to work with AWS.</li></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="ii-sts"></a>II. STS<a aria-hidden="true" tabindex="-1" class="hash-link" href="#ii-sts" title="Direct link to heading">#</a></h2><ol><li><p>Allows to grant limited and temporary access to AWS resources.</p></li><li><p><strong>Token is valid up to one hour (must be refreshed).</strong></p></li><li><p>IAM users can request temporary security credentials for their own use by calling the AWS STS¬†<code>GetSessionToken</code>¬†API. The default expiration for these temporary credentials is 12 hours; the minimum is 15 minutes, and the maximum is 36 hours.</p></li><li><p>How can I use temporary security credentials to call AWS service APIs?</p><ol><li>Use the access key ID and secret access key that are provided with the temporary security credentials</li><li>Use the session token that is provided with the temporary security credentials. Include the session token in the <code>x-amz-security-token</code> header.</li></ol></li><li><p>APIs</p><ol><li><code>AssumeRole</code>: within your own account for enhanced security or cross-account</li><li><code>AssumeRoleWithSAML</code>: return credentials for users logged with SAML</li><li><code>AssumeRoleWithWebIdentity</code>: return credentials for users logged in with identity provider, <strong>AWS recommends using Cognito instead of this</strong>.</li><li><code>GetSessionToken</code>: for MFA from a user&#x27;s root account</li></ol></li><li><p>Using STS to assume a role</p><ol><li>Define an IAM role within your account or cross-account</li><li>Define which principals can access this IAM role</li><li>Use AWS STS to retrieve credentials and impersonate the IAM role you have access to</li><li>Temporary credentials valid for 15-60 minutes.</li></ol></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="iii-aws-active-directory"></a>III. AWS Active Directory<a aria-hidden="true" tabindex="-1" class="hash-link" href="#iii-aws-active-directory" title="Direct link to heading">#</a></h2><ol><li><p>A brief background of Microsoft AD</p><ol><li>Found on any Windows server with AD domain services.</li><li>Database of objects: User, Accounts, Computers, Printers, File shares etc</li><li>Centralized security management, create account, assign permissions</li><li>Object are organized in trees. A group of trees is called forest.</li></ol></li><li><p>AWS managed Microsoft AD</p><ol><li>Create your own AD in AWS, manage users locally</li><li>Supports MFA</li><li>Establish trust connection with your on-prem AD</li></ol></li><li><p>AD connector</p><ol><li>Directory gateway (proxy) to redirect to on-prem AD</li><li>Users are managed on the on-prem AD</li></ol></li><li><p>Simple AD</p><ol><li>AD-compatible managed directory on AWS</li><li>Cannot be joined with on-prem AD</li></ol></li></ol><p><img alt="active directory" src="/aws/assets/images/activedirectory-8a4e820aeb9ee9af48a92aab49a27888.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="iv-aws-organizations"></a>IV. AWS Organizations<a aria-hidden="true" tabindex="-1" class="hash-link" href="#iv-aws-organizations" title="Direct link to heading">#</a></h2><ol><li>Global service to manage multiple AWS accounts.</li><li>The main account is master account and you can&#x27;t change it. Other accounts are members.</li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">Member accounts can only be part of one organization aka no nesting!</span></li><li>Consolidated billing across all accounts - single payment method.</li><li>Pricing benefits from aggregated usage (volume discount for EC2 and S3).</li><li>API available to automate account creation.</li><li>Multi-account strategy<ol><li>Create accounts per dev, per cost center, per env for better isolation</li><li>Multi account vs Multi VPCs</li><li>Use tagging for billing purposes</li><li>Enable CloudTrail on all accounts and send logs to a central S3 bucket</li><li>Establish cross-account roles for admin purposes</li></ol></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="v-organizational-units-ou"></a>V. Organizational Units (OU)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#v-organizational-units-ou" title="Direct link to heading">#</a></h2><ol><li><p>You can create OUs however you want.</p></li><li><p>Leave master account in root OU (good practice).
<img alt="Organization Units" src="/aws/assets/images/ou-d506626f66bcc3061cfccb5037f028d8.png"></p></li><li><p>Service Control Policies (SCP)</p><ol><li>Whitelist or blacklist IAM actions</li><li>Applied at the OU or account level</li><li>Does not apply to master account</li><li>SCP is applied to all users and roles of the account, including root</li><li>SCP does not apply to service-linked roles</li><li><strong>Must have an explicit allow (deny all by default)</strong></li><li>Use cases<ol><li>Prod account cannot use EMR</li><li>Enforce PCI compliance by explicitly disabling services</li></ol></li></ol></li></ol><p><img alt="Root Organization Units" src="/aws/assets/images/rootou-35fa74df35f2936203cc3a9d38e9f79a.png">
<img alt="IAM Allow" src="/aws/assets/images/allow-ccff237ea84ac9c435c441041db8d726.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="vi-advanced-iam"></a>VI. Advanced IAM<a aria-hidden="true" tabindex="-1" class="hash-link" href="#vi-advanced-iam" title="Direct link to heading">#</a></h2><ol><li>IAM conditions ‚Äî <code>aws:SourceIP</code>(restrict client IP from which requests are made)</li></ol><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Version&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;2012-10-17&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Statement&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Effect&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;Allow&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Principal&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token property">&quot;AWS&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;arn:aws:iam::account-id:user/EXAMPLEIAMUSERNAME&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Action&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;sts:AssumeRole&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Condition&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token property">&quot;NotIpAddress&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                    </span><span class="token property">&quot;aws:SourceIp&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;103.15.250.0/24&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><ol start="2"><li><code>aws:RequestedRegion</code> (restrict region API calls are made to)</li></ol><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Version&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;2012-10-17&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Statement&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Sid&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;DenyAllOutsideRequestedRegions&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Effect&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;Deny&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;NotAction&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;cloudfront:*&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;iam:*&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;route53:*&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;support:*&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Resource&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;*&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Condition&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token property">&quot;StringNotEquals&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                    </span><span class="token property">&quot;aws:RequestedRegion&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                        </span><span class="token string" style="color:#f1fa8c">&quot;eu-central-1&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                        </span><span class="token string" style="color:#f1fa8c">&quot;eu-west-1&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                        </span><span class="token string" style="color:#f1fa8c">&quot;eu-west-2&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                        </span><span class="token string" style="color:#f1fa8c">&quot;eu-west-3&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                    </span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><ol start="3"><li>Restrict based on tags</li></ol><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Version&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;2012-10-17&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Statement&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Sid&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;StartStopIfTags&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Effect&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;Allow&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Action&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;ec2:StartInstances&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;ec2:StopInstances&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;ec2:DescribeTags&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Resource&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;arn:aws:ec2:region:account-id:instance/*&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Condition&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token property">&quot;StringEquals&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                    </span><span class="token property">&quot;ec2:ResourceTag/Project&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;DataAnalytics&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                    </span><span class="token property">&quot;aws:PrincipalTag/Department&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;Data&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><ol start="4"><li>Force MFA</li></ol><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Version&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;2012-10-17&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Statement&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Effect&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;Allow&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Action&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;ec2:StopInstances&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;ec2:TerminateInstances&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Resource&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;*&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Condition&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> </span><span class="token property">&quot;Bool&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"> </span><span class="token property">&quot;aws:MultiFactorAuthPresent&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;true&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><ol start="5"><li>IAM for S3<ol><li>ListBucket permission applies to <code>arn:aws:s3:::test</code>(bucket-level permission)</li></ol></li></ol><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Version&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;2012-10-17&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Statement&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Effect&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;Allow&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Action&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;s3:ListBucket&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Resource&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;arn:aws:s3:::test&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Effect&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;Allow&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Action&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;s3:PutObject&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;s3:GetObject&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;s3:DeleteObject&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Resource&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;arn:aws:s3:::test/*&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><ol start="2"><li>But <code>GetObject</code>, <code>PutObject</code> and <code>DeleteObject</code> applies to anything within bucket so to include all, we add <code>arn:aws:s3:::test/*</code> (object-level permission)</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="vii-iam-roles-vs-resource-based-policies"></a>VII. IAM Roles vs Resource Based Policies<a aria-hidden="true" tabindex="-1" class="hash-link" href="#vii-iam-roles-vs-resource-based-policies" title="Direct link to heading">#</a></h2><ol><li>When you assume a role, you give up original permissions of your principal and take the new ones given by the role.</li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">When using resource-based policy, you don&#x27;t have to give up permission of your principal.</span></li></ol><p>##¬†VIII. IAM Permission Boundaries</p><ol><li>The permissions boundary for an IAM entity (user or role) sets the maximum permissions that the entity can have. This can change the effective permissions for that user or role. The effective permissions for an entity are the permissions that are granted by all the policies that affect the user or role.</li><li>Within an account, the permissions for an entity can be affected by identity-based policies, resource-based policies, permissions boundaries, Organizations SCPs, or session policies.</li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">IAM permission boundaries are supported for users and roles (not groups).</span></li><li>Advanced features to use a managed policy to set the maximum permissions an IAM entity can get.</li></ol><p><img alt="No Permissions" src="/aws/assets/images/noperm-1172386c7541458670e4aba3bf8a738e.png"></p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-json codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Version&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;2012-10-17&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;Statement&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Effect&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;Deny&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Action&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;sqs:_&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Resource&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;*&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Action&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;sqs:DeleteQueue&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Effect&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;Allow&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token property">&quot;Resource&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;*&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div></div></div><ol><li><p><strong>Can you create a SQS queue?</strong>
No because there&#x27;s an explicit deny.</p></li><li><p><strong>Can you delete a SQS queue?</strong></p><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">No because there&#x27;s an explicit deny on top which precedes the allow.</span></li><li><p><strong>Can you create an EC2 instance?</strong></p><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">There&#x27;s no explicit deny or allow. Since everything in AWS is deny by default so no.</span></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="x-aws-resource-access-manager-ram"></a>X. AWS Resource Access Manager (RAM)<a aria-hidden="true" tabindex="-1" class="hash-link" href="#x-aws-resource-access-manager-ram" title="Direct link to heading">#</a></h2><ol><li>Share AWS resources with other AWS accounts.</li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">Share with ANY account or those within your organization.</span></li><li>Avoid resource duplication.</li><li>VPC subnets (most common)<ol><li>allow to have all the resources launched in the same subnet</li><li>must be from the same AWS organizations</li><li>cannot share security groups and default VPC</li><li>participants can manage their own resources in there</li></ol></li><li>In the following examples	<ol><li>Account1 owns EC2 and ELB which cannot be modified by 	Account2 or owner</li><li>But network is shared so they can talk to each other 	using private IP</li></ol></li></ol><p><img alt="AWS Ressource Access Manager" src="/aws/assets/images/awsiamvpc-4a465c2004152ff6fa22f287ab533627.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="xi-aws-sso"></a>XI. AWS SSO<a aria-hidden="true" tabindex="-1" class="hash-link" href="#xi-aws-sso" title="Direct link to heading">#</a></h2><ol><li>Centrally managed SSO to access multiple accounts and third-party business applications.</li><li>Integrated with OU and supports SAML 2.0 and AD.</li><li>Centralized permission and CloudTrail audits</li></ol><p><img alt="AWS SSO" src="/aws/assets/images/awssso-0df212a3c28cc3607c0ff7c054d6a880.png"></p><ol start="4"><li><code>AssumeRoleWithSAML</code> vs SSO</li></ol><p><img alt="AWS SAML" src="/aws/assets/images/awssml-a888d893581be2c1780966a36e59de36.png"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="xii-identity-federation"></a>XII. Identity Federation<a aria-hidden="true" tabindex="-1" class="hash-link" href="#xii-identity-federation" title="Direct link to heading">#</a></h2><ol><li>With identity federation, external identities are granted secure access to resources in your AWS account without having to create IAM users. These external identities can come from your corporate identity provider (such as Microsoft Active Directory or from the AWS Directory Service) or from a web identity provider (such as Amazon Cognito, Login with Amazon, Facebook, Google, or any OpenID Connect-compatible provider).</li><li>Federated users (aka external identities) are users you manage outside of AWS in your corporate directory, but to whom you grant access to your AWS account using temporary security credentials. <span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">They differ from IAM users, which are created and maintained in your AWS account.</span></li><li>When you request temporary security credentials for your federated user using an <code>AssumeRole</code> API, you can optionally include an access policy with the request. <span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">The federated user‚Äôs privileges are the intersection of permissions granted by the access policy passed with the request and the access policy attached to the IAM role that was assumed.</span></li><li>Once the identity federation console session times out, the user is presented with a message stating that the console session has timed out and that they need to request a new session.</li><li>Prefer Cognito over <code>AssumeRoleWithWebIdentity</code> API.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="xiii-iam-tips"></a>XIII. IAM Tips<a aria-hidden="true" tabindex="-1" class="hash-link" href="#xiii-iam-tips" title="Direct link to heading">#</a></h2><ol><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">IAM is a free service.</span></li><li><p>To sign in to the AWS Management Console as an IAM user, you must provide your account ID or account alias in addition to your user name and password.</p></li><li><p>To sign in programmatically (CLI and API), you must provide access key ID and secret access key.</p></li><li><p>If a company is using Microsoft Active Directory which implements Security Assertion Markup Language (SAML), you can set up a SAML-Based Federation for API Access to your AWS cloud. In this way, you can easily connect to AWS using the login credentials of your on-premises network.</p></li><li><p>Access keys ‚Üí API calls</p></li><li><p>Key pair ‚Üí logging in EC2</p></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">You can assign a role to an EC2 instance that is already running. Only one role per EC2.</span></li><li><p>You must grant an IAM user two distinct permissions to successfully launch EC2 instances with roles:</p><ol><li>Permission to launch EC2 instances.</li><li>Permission to associate an IAM role with EC2 instances.</li></ol></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">You can create a managed policy and assign it to the group of users and the role on the Amazon EC2 instance.</span></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">Can users SSH to EC2 instances using their AWS username and password? No, you need the key pair!</span></li><li><p>We can utilize AWS Config to check for compliance on the password policy by configuring the Config rule to check the <code>IAM_PASSWORD_POLICY</code> on an account.</p></li><li><p>IAM is eventually consistent.</p></li><li><p>APIs can be enabled to use MFA protection.</p></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">Users, roles, federated users and applications are all &quot;principals&quot;. Your root account is your &quot;first principal&quot;.</span></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">By default, a brand new IAM user has NO permissions. You must grant access keys and attach necessary permissions to enable them to take any action.</span></li><li><p>AWS Service Role is a role that a service assumes to perform actions in your account on your behalf.</p></li><li><p>You can manage and rotate programmatically a user&#x27;s access keys and X.509 certificates via the IAM APIs, AWS CLI, or IAM console.</p></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">AWS recommend that you use the AWS SDKs to make programmatic API calls to IAM. However, you can also use the IAM Query API to make direct calls to the IAM web service. An access key ID and secret access key must be used for authentication when using the Query API.</span></li><li><p>Currently, IAM users can use their SSH keys only with AWS CodeCommit to access their repositories.</p></li><li><p>You assume an IAM role by calling the AWS Security Token Service (STS) AssumeRole APIs (in other words, <code>AssumeRole</code>, <code>AssumeRoleWithWebIdentity</code>, and <code>AssumeRoleWithSAML</code>). These APIs return a set of temporary security credentials that applications can then use to sign requests to AWS service APIs.</p></li><li><span style="background-color:#FF9900;border-radius:2px;color:#fff;padding:0.2rem">There is no limit to the number of IAM roles you can assume, but you can only act as one IAM role when making requests to AWS services.</span></li><li><p>You can log IAM actions, STS actions, and AWS Management Console sign-ins by activating AWS CloudTrail.</p></li><li><p>If you got your certificate from a third-party CA, import the certificate into <strong>AWS Certificate Manager</strong> OR upload it to the <strong>IAM Certificate Store</strong>.</p></li></ol></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/aws/docs/notes_sg"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Security Groups</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/aws/docs/notes_ec2"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">EC2 ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#i-introduction" class="table-of-contents__link">I. Introduction</a></li><li><a href="#ii-sts" class="table-of-contents__link">II. STS</a></li><li><a href="#iii-aws-active-directory" class="table-of-contents__link">III. AWS Active Directory</a></li><li><a href="#iv-aws-organizations" class="table-of-contents__link">IV. AWS Organizations</a></li><li><a href="#v-organizational-units-ou" class="table-of-contents__link">V. Organizational Units (OU)</a></li><li><a href="#vi-advanced-iam" class="table-of-contents__link">VI. Advanced IAM</a></li><li><a href="#vii-iam-roles-vs-resource-based-policies" class="table-of-contents__link">VII. IAM Roles vs Resource Based Policies</a></li><li><a href="#x-aws-resource-access-manager-ram" class="table-of-contents__link">X. AWS Resource Access Manager (RAM)</a></li><li><a href="#xi-aws-sso" class="table-of-contents__link">XI. AWS SSO</a></li><li><a href="#xii-identity-federation" class="table-of-contents__link">XII. Identity Federation</a></li><li><a href="#xiii-iam-tips" class="table-of-contents__link">XIII. IAM Tips</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/aws/styles.e3d237d5.js"></script>
<script src="/aws/runtime~main.5987bc8c.js"></script>
<script src="/aws/main.db8832c0.js"></script>
<script src="/aws/2.eacc328a.js"></script>
<script src="/aws/3.5084f581.js"></script>
<script src="/aws/66.73ad6aef.js"></script>
<script src="/aws/67.520034c4.js"></script>
<script src="/aws/935f2afb.52a1d31c.js"></script>
<script src="/aws/17896441.17a33e11.js"></script>
<script src="/aws/a75ebbb0.ff55213a.js"></script>
</body>
</html>